# This is a basic workflow to help you get started with Actions

name: Sync Issue with ADO

# Controls when the action will run.
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  issues:
    types: [labeled, closed, reopened, edited]
  issue_comment:
    types: [created]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  alert:
    runs-on: ubuntu-latest
    name: ADOSync workflow
    steps:
    - uses: captainbrosset/github-actions-issue-to-work-item@master
      env:
        github_token: "${{ secrets.GH_PERSONAL_ACCESS_TOKEN }}"
        ado_token: '${{ secrets.ADO_PERSONAL_ACCESS_TOKEN }}'
        ado_organization: 'microsoft'
        ado_project: 'Edge'
        ado_area_path: 'Edge\Web Experience\Developer Tools\F12 Tools\VSCode Extension'
        ado_tags: 'DevToolsVSCodeExtension_GitHub'
        ado_tag_on_close: 'DevToolsVSCodeExtension_GitHub_Closed'
        ado_bypassrules: false
        ado_set_labels: false
        create_on_tagging: true
Run captainbrosset/github-actions-issue-to-work-item@master
  env:
    github_token: ***
    ado_token: ***
    ado_organization: microsoft
    ado_project: Edge
    ado_area_path: Edge\Web Experience\Developer Tools\F12 Tools\VSCode Extension
    ado_tags: DevToolsVSCodeExtension_GitHub
    ado_tag_on_close: DevToolsVSCodeExtension_GitHub_Closed
    ado_bypassrules: false
    ado_set_labels: false
    create_on_tagging: true
Set values from payload & env
Check to see if work item already exists
Finding workitem
ADO query: SELECT [System.Id], [System.WorkItemType], [System.Description], [System.Title], [System.AssignedTo], [System.State], [System.Tags] FROM workitems WHERE [System.TeamProject] = @project AND [System.Title] CONTAINS '[GitHub #1516]' AND [System.AreaPath] = 'Edge\Web Experience\Developer Tools\F12 Tools\VSCode Extension'
Error: queryByWiql failure
Error: Request timeout: /Edge/_apis/wit/wiql
    at ClientRequest.<anonymous> (/home/runner/work/_actions/captainbrosset/github-actions-issue-to-work-item/master/node_modules/typed-rest-client/HttpClient.js:313:26)
    at Object.onceWrapper (events.js:420:28)
    at ClientRequest.emit (events.js:314:20)
    at TLSSocket.emitRequestTimeout (_http_client.js:715:9)
    at Object.onceWrapper (events.js:420:28)
    at TLSSocket.emit (events.js:326:22)
    at TLSSocket.Socket._onTimeout (net.js:483:8)
    at listOnTimeout (internal/timers.js:554:17)
    at processTimers (internal/timers.js:497:7)
Error: TypeError: (s || "").replace is not a function
